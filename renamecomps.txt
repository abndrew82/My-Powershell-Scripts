foreach ($line in $csv) { Invoke-Command -ComputerName $line.oldname -Command { Rename-Computer $newname } -Credential (Get-Credential) }